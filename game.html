<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ú–æ–π –ø–∏—Ç–æ–º–µ—Ü üê±</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, sans-serif;
    background: linear-gradient(135deg, #f9f9f9, #e8f4ff);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  #game-container {
    background: #fff;
    border-radius: 16px;
    padding: 20px;
    width: 320px;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    position: relative;
  }
  #notification {
    position: absolute;
    top: -40px;
    left: 50%;
    transform: translateX(-50%);
    background: #ffd166;
    color: #333;
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: bold;
    opacity: 0;
    pointer-events: none;
    transition: all 0.4s ease;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  }
  #notification.show {
    top: -10px;
    opacity: 1;
  }
  #notification.coins { background: #ffd166; }
  #notification.exp { background: #4cc9f0; color: white; }

  h1 {
    margin-bottom: 10px;
    font-size: 24px;
    color: #333;
  }
  #pet-emoji {
    font-size: 80px;
    margin-bottom: 10px;
    filter: drop-shadow(0 0 10px gold);
    animation: glow 2s ease-in-out infinite alternate;
  }
  @keyframes glow {
    from { filter: drop-shadow(0 0 5px gold); }
    to { filter: drop-shadow(0 0 20px gold); }
  }
  #level, #progress, #coins {
    margin: 5px 0;
    font-weight: bold;
  }
  button {
    display: block;
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s;
  }
  #feed-btn { background: #ffd166; }
  #feed-btn:disabled { background: #ffe8a1; cursor: default; }
  #bonus-btn { background: #06d6a0; }
  #bonus-btn:disabled { background: #a3f0d6; cursor: default; }
  #mini-game-btn { background: #118ab2; color: #fff; }
  #mini-game-btn:disabled { background: #a0cfe0; cursor: default; }
  #timer-feed, #timer-bonus {
    font-size: 14px;
    color: #555;
  }
  #mini-game-area {
    margin-top: 10px;
    display: none;
  }
  #mini-game-area input {
    width: 100%;
    padding: 8px;
    margin-top: 6px;
    border: 1px solid #ccc;
    border-radius: 6px;
    text-align: center;
    font-size: 16px;
  }
</style>
</head>
<body>

<div id="game-container">
  <div id="notification"></div>
  <h1>–ú–æ–π –ø–∏—Ç–æ–º–µ—Ü</h1>
  <div id="pet-emoji">üê±</div>

  <div id="level"></div>
  <div id="progress"></div>
  <div id="coins"></div>

  <button id="feed-btn">–ü–æ–∫–æ—Ä–º–∏—Ç—å</button>
  <div id="timer-feed"></div>

  <button id="bonus-btn">–ë–æ–Ω—É—Å</button>
  <div id="timer-bonus"></div>

  <button id="mini-game-btn">–ú–∏–Ω–∏-–∏–≥—Ä–∞</button>

  <div id="mini-game-area">
    <div id="mini-task"></div>
    <input type="number" id="mini-answer" placeholder="–û—Ç–≤–µ—Ç">
    <button id="mini-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>

<script>
  // ================== –î–ê–ù–ù–´–ï ==================
  let state = {
    level: 1,
    progress: 0,
    coins: 10,
    feedCount: 5,
    feedCooldown: 0,
    bonusCooldown: 0
  };

  const levelEl = document.getElementById('level');
  const progressEl = document.getElementById('progress');
  const coinsEl = document.getElementById('coins');
  const feedBtn = document.getElementById('feed-btn');
  const bonusBtn = document.getElementById('bonus-btn');
  const miniBtn = document.getElementById('mini-game-btn');
  const timerFeedEl = document.getElementById('timer-feed');
  const timerBonusEl = document.getElementById('timer-bonus');
  const miniArea = document.getElementById('mini-game-area');
  const miniTask = document.getElementById('mini-task');
  const miniAnswer = document.getElementById('mini-answer');
  const miniSubmit = document.getElementById('mini-submit');
  const notification = document.getElementById('notification');

  let currentMiniAnswer = null;

  // ================== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ==================
  function showNotification(type, text) {
    notification.textContent = text;
    notification.className = '';
    notification.classList.add('show', type);
    setTimeout(() => {
      notification.classList.remove('show');
    }, 2500);
  }

  // ================== –°–û–•–†–ê–ù–ï–ù–ò–ï ==================
  function saveState() {
    localStorage.setItem('petGameState', JSON.stringify(state));
  }
  function loadState() {
    const saved = localStorage.getItem('petGameState');
    if (saved) state = JSON.parse(saved);
  }

  // ================== UI ==================
  function updateUI() {
    levelEl.textContent = `–£—Ä–æ–≤–µ–Ω—å: ${state.level}`;
    progressEl.textContent = `–ü—Ä–æ–≥—Ä–µ—Å—Å: ${state.progress.toFixed(1)}%`;
    coinsEl.textContent = `–ú–æ–Ω–µ—Ç—ã: ${state.coins}`;
    feedBtn.textContent = `–ü–æ–∫–æ—Ä–º–∏—Ç—å (${state.feedCount})`;
    feedBtn.disabled = state.feedCount <= 0;
    bonusBtn.disabled = state.bonusCooldown > 0;
  }

  function increaseProgress(amount) {
    state.progress += amount;
    if (state.progress >= 100) {
      state.progress -= 100;
      state.level++;
    }
    if (state.progress < 0) state.progress = 0;
  }

  // ================== –ö–û–†–ú–õ–ï–ù–ò–ï ==================
  feedBtn.addEventListener('click', () => {
    if (state.feedCount > 0) {
      const exp = state.feedCount === 5 ? 2 : 0.75;
      increaseProgress(exp);
      showNotification('exp', `+${exp}% –æ–ø—ã—Ç–∞`);
      state.feedCount--;
      if (state.feedCount === 0) {
        state.feedCooldown = 120;
      }
      saveState();
      updateUI();
    }
  });

  // ================== –ë–û–ù–£–° ==================
  bonusBtn.addEventListener('click', () => {
    const reward = Math.random() < 0.5 ? 'coins' : 'exp';
    if (reward === 'coins') {
      const amount = Math.floor(Math.random()*3)+1;
      state.coins += amount;
      showNotification('coins', `+${amount} –±–æ–Ω—É—Å–Ω—ã—Ö –º–æ–Ω–µ—Ç`);
    } else {
      const amount = +(Math.random()*0.6+0.2).toFixed(2);
      increaseProgress(amount);
      showNotification('exp', `+${amount}% –±–æ–Ω—É—Å–Ω–æ–≥–æ –æ–ø—ã—Ç–∞`);
    }
    state.bonusCooldown = 30;
    saveState();
    updateUI();
  });

  // ================== –ú–ò–ù–ò-–ò–ì–†–ê ==================
  miniBtn.addEventListener('click', () => {
    miniArea.style.display = 'block';
    const a = Math.floor(Math.random()*50)+1;
    const b = Math.floor(Math.random()*50)+1;
    const ops = ['+','-','*'];
    const op = ops[Math.floor(Math.random()*ops.length)];
    miniTask.textContent = `–°–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç ${a} ${op} ${b}?`;
    switch(op){
      case '+': currentMiniAnswer = a+b; break;
      case '-': currentMiniAnswer = a-b; break;
      case '*': currentMiniAnswer = a*b; break;
    }
    miniAnswer.value = '';
    miniAnswer.focus();
  });

  miniSubmit.addEventListener('click', () => {
    const ans = Number(miniAnswer.value);
    if (ans === currentMiniAnswer) {
      state.coins += 1;
      increaseProgress(0.1);
      showNotification('coins', '+1 –º–æ–Ω–µ—Ç–∞');
    } else {
      state.coins = Math.max(0, state.coins-1);
      increaseProgress(-0.5);
      showNotification('exp', '-0.5% –æ–ø—ã—Ç–∞, -1 –º–æ–Ω–µ—Ç–∞');
    }
    miniArea.style.display = 'none';
    saveState();
    updateUI();
  });

  // ================== –¢–ê–ô–ú–ï–†–´ ==================
  function tickCooldowns() {
    if (state.feedCooldown > 0) {
      state.feedCooldown--;
      let m = Math.floor(state.feedCooldown/60);
      let s = state.feedCooldown%60;
      timerFeedEl.textContent = `–î–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑: ${m}:${s.toString().padStart(2,'0')}`;
      feedBtn.disabled = true;
      if (state.feedCooldown === 0) {
        state.feedCount = 5;
        timerFeedEl.textContent = '';
      }
    }

    if (state.bonusCooldown > 0) {
      state.bonusCooldown--;
      let m = Math.floor(state.bonusCooldown/60);
      let s = state.bonusCooldown%60;
      timerBonusEl.textContent = `–î–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑: ${m}:${s.toString().padStart(2,'0')}`;
      bonusBtn.disabled = true;
      if (state.bonusCooldown === 0) {
        timerBonusEl.textContent = '';
      }
    }
    saveState();
    updateUI();
  }

  // ================== –ó–ê–ü–£–°–ö ==================
  loadState();
  updateUI();
  setInterval(tickCooldowns, 1000);
</script>
</body>
</html>
